<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Onglet 4 - Sélection du Matériau</title>
    
    <!-- Polices et bibliothèques externes -->
    <link href="https://fonts.googleapis.com/css2?family=Libre+Bodoni:ital,wght@1,400&family=Playfair+Display:wght@400;700&family=Montserrat:wght@400;500&display=swap" rel="stylesheet">
    <!-- Supprimez les scripts non utilisés -->
    <!-- <script src="https://cdn.plot.ly/plotly-latest.min.js"></script> -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> -->
    <!-- Supprimez PapaParse -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script> -->

    <!-- Script générique -->
    <script src="../script.js" defer></script>
    <link rel="stylesheet" href="../styles.css">
</head>
<body>
    <!-- Image d'en-tête -->
    <div class="header-image">
        <div class="header-overlay">ENSAM x Cartier</div> <!-- Texte superposé -->
    </div>

    <!-- Menu de navigation -->
    <header class="menu">
        <nav>
            <ul>
                <li><a href="../index.html">Accueil</a></li>
                <li><a href="onglet1.html">Onglet 1</a></li>
                <li><a href="onglet2.html">Onglet 2</a></li>
                <li><a href="onglet3.html">Onglet 3</a></li>
                <li><a href="onglet4.html">Onglet 4</a></li>
                <li><a href="contact.html">Contact</a></li>
            </ul>
        </nav>
    </header>

    <!-- Contenu principal -->
    <main class="content">
        <h1>Analyse des impacts environnementaux par matériau</h1>
        <p>Sélectionnez un matériau pour voir les détails de son impact environnemental selon différentes méthodes de traitement de fin de vie.</p>

        <!-- Menu déroulant des matériaux -->
        <label for="materialDropdown">Choisissez un matériau :</label>
        <select id="materialDropdown">
            <option value="">Sélectionnez un matériau</option>
        </select>

        <!-- Division pour afficher les informations du matériau sélectionné -->
        <div id="materialInfo">
            <p>Sélectionnez un matériau pour voir les informations.</p>
        </div>
    </main>
    <div>
    <label for="countrySelector">Sélectionnez un pays :</label>
    <select id="countrySelector">
        <option value="Germany">Allemagne</option>
        <option value="France">France</option>
        <option value="Italy">Italie</option>
        <option value="Holland">Pays-Bas</option>
        <option value="Spain">Espagne</option>
        <option value="Switzerland">Suisse</option>
        <option value="UK">Royaume-Uni</option>
        <option value="China">Chine</option>
        <option value="USA">États-Unis</option>
        <!-- Ajoutez d'autres options de pays si nécessaire -->
    </select>
</div>
<div id="pieChartMass"></div>
<div id="pieChartCO2"></div>
    
    <!-- Pied de page -->
    <div class="footer">
        <p>&copy; 2024/2025 Baptiste Légier, Pierre-Vincent Arcade, Valentin Hyaumet. Tous droits réservés.</p>
    </div>

    <!-- Script pour charger le fichier JSON et gérer l'interaction -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Charger les données JSON
        fetch('../static/json/impactfdvmat.json')
          .then(response => response.json())
          .then(data => {
            const materials = data['Feuil1'];
            const dropdown = document.getElementById('materialDropdown');
            
            // Peupler le menu déroulant
            materials.forEach(material => {
              const option = document.createElement('option');
              option.value = material['Matériau'];
              option.text = material['Matériau'];
              dropdown.add(option);
            });

            // Écouter les changements du menu déroulant
            dropdown.addEventListener('change', function() {
              const selectedMaterial = this.value;
              const materialInfoDiv = document.getElementById('materialInfo');

              if (selectedMaterial === "") {
                materialInfoDiv.innerHTML = '<p>Sélectionnez un matériau pour voir les informations.</p>';
                return;
              }

              // Trouver les données du matériau sélectionné
              const materialData = materials.find(item => item['Matériau'] === selectedMaterial);
              
              if (materialData) {
                // Construire le HTML pour afficher les informations du matériau
                materialInfoDiv.innerHTML = `
                  <h2>${materialData['Matériau']}</h2>
                  <p><strong>Incinération - Impact (kg éq. CO2/tonne) :</strong> ${materialData['Incinération - Impact (kg éq. CO2/tonne)']}</p>
                  <p><strong>Recyclage - Impact (kg éq. CO2/tonne) :</strong> ${materialData['Recyclage - Impact (kg éq. CO2/tonne)']}</p>
                  <p><strong>Méthanisation - Impact (kg éq. CO2/tonne) :</strong> ${materialData['Méthanisation - Impact (kg éq. CO2/tonne)']}</p>
                  <p><strong>Incinération - Émissions Évitées (kg éq. CO2/tonne) :</strong> ${materialData['Incinération - Émissions Évitées (kg éq. CO2/tonne)']}</p>
                  <p><strong>Recyclage - Émissions Évitées (kg éq. CO2/tonne) :</strong> ${materialData['Recyclage - Émissions Évitées (kg éq. CO2/tonne)']}</p>
                  <p><strong>Méthanisation - Émissions Évitées (kg éq. CO2/tonne) :</strong> ${materialData['Méthanisation - Émissions Évitées (kg éq. CO2/tonne)']}</p>
                `;
              } else {
                materialInfoDiv.innerHTML = '<p>Aucune donnée disponible pour ce matériau.</p>';
              }
            });

          })
          .catch(error => console.error('Erreur lors du chargement du fichier JSON :', error));
    });
    // Charger les données JSON
const data = [
    {
        "STAINLESS STEEL": "Germany",
        "MDF LIGHT": "209.2",
        "RECYCLED CARDBOARD": "40.6",
        "RECYCLED POLYESTER": "32.1",
        "MICROFIBER": "14.7",
        "ALUMINIUM": "4.6",
        "PAPER": "0.2",
        "RECYCLED PMMA": "2.7",
        "RECYCLED PP": "6.7",
        "PVA": "4.8",
        "PET": "0.1"
    },
    // Ajoutez les autres pays ici...
];

// Fonction pour obtenir les données d'un pays sélectionné
function getCountryData(country) {
    return data.find(item => item["STAINLESS STEEL"] === country);
}

// Fonction pour créer les graphiques circulaires
function createPieCharts(country) {
    const countryData = getCountryData(country);
    if (!countryData) return;

    const labels = Object.keys(countryData).slice(1); // Exclure le pays
    const masses = Object.values(countryData).slice(1).map(val => parseFloat(val.replace(",", ".")));

    // Calculer le total pourcentage pour chaque graphique
    const totalMass = masses.reduce((acc, val) => acc + val, 0);
    const massPercentages = masses.map(mass => (mass / totalMass) * 100);

    // Configuration du graphique de masse
    const massConfig = {
        type: 'pie',
        data: {
            labels: labels,
            datasets: [{
                data: massPercentages,
                backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF', '#FF9F40'],
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    position: 'top',
                },
                title: {
                    display: true,
                    text: 'Pourcentage de masse par matériau'
                }
            }
        }
    };

    // Dessiner les graphiques
    const ctxMass = document.getElementById('pieChartMass').getContext('2d');
    new Chart(ctxMass, massConfig);
}

// Mettre à jour les graphiques lors de la sélection d'un pays
document.getElementById('countrySelector').addEventListener('change', (event) => {
    const selectedCountry = event.target.value;
    createPieCharts(selectedCountry);
});

// Charger les graphiques initiaux avec le premier pays sélectionné
window.onload = function () {
    const initialCountry = document.getElementById('countrySelector').value;
    createPieCharts(initialCountry);
};
    </script>

</body>
</html>
